{"version":3,"sources":["webpack:///webpack/bootstrap 6e0d6efbd834c4b81a18","webpack:///./src/providers/stripe/stripe.module.js","webpack:///./src/providers/stripe/stripe.provider.js","webpack:///./src/providers/stripe/stripe.http.service.js","webpack:///./src/providers/stripe/stripe.source.service.js","webpack:///./src/providers/stripe/stripe.directives.js","webpack:///./src/providers/stripe/directives/index.js","webpack:///./src/providers/stripe/directives/add-card.js","webpack:///./src/payments.js"],"names":["angular","module","provider","service","stripeConfigProvider","API_KEY","BASE_URL","DEFAULTS","add_card_amount","currency","redirect","set","configs","defaults","apiKey","baseUrl","extend","stripeConfig","key","base_url","$get","stripeConfigFactory","httpService","$http","$httpParamSerializerJQLike","options","callback","data","url","indexOf","headers","then","R","status","catch","ERR","error","$injector","default","stripeSource","$q","forEach","hopArr","arr","createCard","requestObject","newCard","type","card","val","billing_add","aVal","aKey","mVal","mKey","success","fail","create3DSecureCallback","create3DSecure","doRequest","method","cardResponse","three_d_secure","_3D","amount","id","return_url","redirect_url","default_redirect","window","location","href","stripe3dsCallback","makeIFrame","authSource","charge","r","stripe3dsResponse","tElm","targetElement","element","append","console","log","innerHTML","nativeElement","poolingCallback","poolCallback","watchSource","client_secret","source","result","directive","Factory","addCard","restrict","scope","onSuccess","onFail","template","$scope","iElm","iAttrs","noop","save","$inject","exports"],"mappings":"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","file":"payments.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6e0d6efbd834c4b81a18","/**\r\n* stripe Module\r\n*\r\n* Stripe service provider\r\n*/\r\nimport stripeProvider from \"./stripe.provider.js\";\r\nimport stripeHttpService from \"./stripe.http.service.js\";\r\nimport stripeSourceService from \"./stripe.source.service.js\";\r\nimport stripeDirectives from \"./stripe.directives.js\";\r\n\r\nexport default angular.module('stripe', ['stripe.directives'])\r\n  .provider('stripeConfig', stripeProvider)\r\n  .service('httpService', stripeHttpService)\r\n  .service('stripeSource', stripeSourceService)\r\n  // ;\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/stripe.module.js","/**\r\n * @todo Improve this code\r\n */\r\n\r\nfunction stripeConfigProvider() {\r\n  var API_KEY = false;\r\n  var BASE_URL = 'https://api.stripe.com/v1'\r\n  var DEFAULTS = {\r\n    add_card_amount: 100,\r\n    currency: 'usd',\r\n    redirect: null\r\n  }\r\n\r\n  this.set = (configs, defaults) => {\r\n    API_KEY = configs.apiKey;\r\n    if (configs.baseUrl) BASE_URL = configs.baseUrl;\r\n    DEFAULTS = angular.extend({}, DEFAULTS, defaults);\r\n  };\r\n\r\n  function stripeConfig(key, base_url, defaults) {\r\n    this.key = key;\r\n    this.base_url = base_url;\r\n    this.defaults = defaults;\r\n  }\r\n\r\n  this.$get = [function stripeConfigFactory() {\r\n\r\n    // let's assume that the stripeConfig constructor was also changed to\r\n    // accept and use the key argument\r\n    return new stripeConfig(API_KEY, BASE_URL, DEFAULTS);\r\n  }];\r\n}\r\n// module.exports = stripeConfigProvider;\r\nexport default stripeConfigProvider;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/stripe.provider.js","\r\nclass httpService {\r\n  constructor($http, $httpParamSerializerJQLike, stripeConfig) {\r\n    this.$http = $http;\r\n    this.stripeConfig = stripeConfig;\r\n    this.$httpParamSerializerJQLike = $httpParamSerializerJQLike;\r\n  }\r\n  doRequest(options, callback) {\r\n    const configs = this.stripeConfig;\r\n    if (options.data) options.data.key = configs.key;\r\n\r\n    options.url = (options.url.indexOf(configs.base_url) === -1)\r\n      ? `${configs.base_url}${options.url}`\r\n      : options.url;\r\n    options.data = this.$httpParamSerializerJQLike(options.data);\r\n    options.headers = angular.extend({ 'Content-Type': 'application/x-www-form-urlencoded' }, options.headers);\r\n    return (typeof callback !== 'function')\r\n    ? this.$http(options)\r\n    : this.$http(options)\r\n        .then(R => callback(R.status, R.data))\r\n        .catch(ERR => callback(ERR.status, (ERR.error || ERR.data || ERR)))\r\n  }\r\n}\r\n\r\nhttpService.$injector = ['$http', '$httpParamSerializerJQLike', 'stripeConfig'];\r\n\r\nexport { httpService as default }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/stripe.http.service.js","/**\r\n* stripe.source Module\r\n*\r\n* Deal with stripe sources\r\n* @see [description]\r\n*/\r\nstripeSource.$injector = ['httpService', 'stripeConfig', '$q'];\r\n\r\nfunction stripeSource(httpService, stripeConfig, $q) {\r\n  const extend = angular.extend;\r\n  const forEach = angular.forEach;\r\n  const hopArr = (arr, key) => arr.indexOf(key) > -1;\r\n  return {\r\n    createCard\r\n  }\r\n\r\n  function createCard(requestObject) {\r\n    const newCard = {\r\n      type: 'card'\r\n    };\r\n    forEach(requestObject.card, (val, key) => {\r\n      if (hopArr['number', 'cvc', 'exp_month', 'exp_year'], key) {\r\n        newCard[`card[${key}]`] = val;\r\n      }\r\n    });\r\n    if (requestObject.billing_add) {\r\n      forEach(requestObject.billing_add, (val, key) => {\r\n        if (hopArr(['email', 'name', 'phone'], key)) return newCard[`owner[${key}]`] = val;\r\n        else if (key === 'address') {\r\n          forEach(val, (aVal, aKey) => {\r\n            if (hopArr(['postal_code', 'city', 'country', 'line1', 'line2', 'state'], aKey)) {\r\n              return newCard[`owner[address][${aKey}]`] = aVal;\r\n            }\r\n          })\r\n        }\r\n        else if (key === 'metadata') {\r\n          forEach(val, (mVal, mKey) => (newCard[`metadata[${key}]`] = val))\r\n        }\r\n      });\r\n    }\r\n\r\n    /* Send Request */\r\n    return new $q((success, fail) => {\r\n      const create3DSecureCallback = create3DSecure(requestObject, success, fail)\r\n      return httpService.doRequest({\r\n        data: newCard,\r\n        url: '/sources',\r\n        method: 'POST'\r\n      }, create3DSecureCallback)\r\n    })\r\n    // .then(nomi => {\r\n    //   console.log('Nomi', nomi);\r\n    //   return nomi;\r\n    // })\r\n  }\r\n\r\n  function create3DSecure(requestObject, success, fail) {\r\n    return (status, cardResponse) => {\r\n      if (status !== 200 || cardResponse.error) {\r\n        return fail(cardResponse.error || cardResponse)\r\n      }\r\n      \r\n      if (cardResponse.card.three_d_secure === 'not_supported' && cardResponse.status === 'chargeable') {\r\n        return success(cardResponse);\r\n      }\r\n      if (cardResponse.card.three_d_secure === 'optional' || cardResponse.card.three_d_secure === 'required') {\r\n        const _3D = extend({}, {\r\n          amount:   stripeConfig.defaults.add_card_amount,\r\n          currency: stripeConfig.defaults.currency\r\n        }, {\r\n          type: 'three_d_secure',\r\n          three_d_secure: { card: cardResponse.id },\r\n          redirect: {\r\n            return_url: ( requestObject.redirect_url || stripeConfig.default_redirect || window.location.href )\r\n          }\r\n        });\r\n        const stripe3dsCallback = makeIFrame(requestObject, success, fail);\r\n        return httpService.doRequest({\r\n          data: _3D,\r\n          url: '/sources',\r\n          method: 'POST'\r\n        }, stripe3dsCallback);\r\n      }\r\n      return fail(cardResponse);\r\n    }\r\n\r\n    function authSource(requestObject, success, fail) {\r\n      /* Working ON it*/\r\n      return (status, cardResponse) => {\r\n        const charge = {\r\n          id: cardResponse.id,\r\n          amount: stripeConfig.defaults.add_card_amount\r\n        };\r\n        return httpService.doRequest({\r\n          data: charge,\r\n          method: 'POST',\r\n          url: '/charges'\r\n        })\r\n        .then(r => success(r.data))        \r\n        .catch(r => fail(r.error))\r\n      }\r\n      // .then(R => success(R.data))\r\n      // .catch(ERR => fail(ERR.error));\r\n    }\r\n\r\n    function makeIFrame(requestObject, success, fail) {\r\n      return (status, stripe3dsResponse) => {\r\n        if (status !== 200 || stripe3dsResponse.error) {\r\n          return fail(stripe3dsResponse.error || stripe3dsResponse)\r\n        }\r\n        var tElm = requestObject.targetElement;\r\n        if (!tElm) {\r\n          tElm = angular.element('<div></div>')[0]\r\n          angular.element('body').append(tElm)\r\n        }\r\n        console.log('tElm ->', tElm);\r\n        tElm.innerHTML = `<iframe style=\"width:100%; height: 800px;\" frameborder=\"0\" src=\"${stripe3dsResponse.redirect.url}\"></iframe>`;\r\n        requestObject.nativeElement = tElm;\r\n        const poolingCallback = poolCallback(requestObject, success, fail);\r\n        function watchSource () {\r\n          return httpService.doRequest({\r\n            url: `/sources/${stripe3dsResponse.id}?key=${stripeConfig.key}&client_secret=${stripe3dsResponse.client_secret}`\r\n          })\r\n          .then(R => {\r\n            const source = R.data;\r\n            if (source.status === 'pending') return true;\r\n            return poolingCallback(R.status, source)\r\n          })\r\n          // .delay(1000)\r\n          .then(result => {\r\n            if (result === true) return watchSource();\r\n            return result;\r\n          })\r\n          .catch(fail);\r\n\r\n        }\r\n        return watchSource();\r\n      }\r\n      \r\n      function poolCallback(requestObject, success, fail) {\r\n        return (status, source) => {\r\n          if (status !== 200 || source.error) {\r\n            return fail(source.error)\r\n          }\r\n          else if (source.status === 'canceled' || source.status === 'consumed' || source.status === 'failed') {\r\n            requestObject.nativeElement.innerHTML = \"\";\r\n            fail(source.status);\r\n          }\r\n          else if (/* source.three_d_secure.authenticated && */ source.status === 'chargeable') {\r\n            /* some cards do not need to be authenticated, like the 4242 4242 4242 4242 */\r\n            requestObject.nativeElement.innerHTML = \"\";\r\n            success(source)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default stripeSource;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/stripe.source.service.js","import { addCard } from \"./directives\";\r\n\r\nexport default angular.module('stripe.directives', [])\r\n  .directive('createSourceToStripe', addCard.Factory)\r\n  ;\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/stripe.directives.js","import addCard from \"./add-card\"\r\n\r\nexport {\r\n  addCard\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/directives/index.js","\r\nclass addCard {\r\n  constructor(stripeSource) {\r\n    this.restrict = 'EA';\r\n    this.stripeSource = stripeSource;\r\n    this.scope = { source: '=', onSuccess: '&', onFail: '&' }\r\n    this.template = '<div><button ng-click=\"save()\">Save to Stripe</button></div>';\r\n  }\r\n  link($scope, iElm, iAttrs) {\r\n    $scope.onFail = $scope.onFail || angular.noop;\r\n    $scope.onSuccess = $scope.onSuccess || angular.noop;\r\n    $scope.source.targetElement = $scope.source.targetElement;\r\n    if (!$scope.source.targetElement) {\r\n      $scope.source.targetElement = angular.element('<div>')[0];\r\n      iElm.append($scope.source.targetElement)\r\n    }\r\n    $scope.save = () => {\r\n      this.stripeSource.createCard($scope.source)\r\n        .then(source => $scope.onSuccess({source}))\r\n        .catch(error => $scope.onFail({error}))        \r\n    }\r\n  }\r\n  static Factory(stripeSource) {\r\n    return new addCard(stripeSource);\r\n  }\r\n}\r\naddCard.Factory.$inject = ['stripeSource'];\r\n// addCard.$inject = [];\r\nexport { addCard as default }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/stripe/directives/add-card.js","/**\r\n* ng-payments Module\r\n*\r\n* ONe package to deal with multi payment methods for noe stripe only\r\n*/\r\nimport stripe from \"./providers/stripe/stripe.module\"\r\nmodule.exports = angular.module('ng-payments', ['stripe']);\n\n\n// WEBPACK FOOTER //\n// ./src/payments.js"],"sourceRoot":""}