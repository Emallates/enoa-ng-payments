!function(e){function t(n){if(r[n])return r[n].exports;var u=r[n]={i:n,l:!1,exports:{}};return e[n].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(1),a=n(u),i=r(2),o=n(i),c=r(3),s=n(c),l=r(4);n(l);t.default=angular.module("stripe",["stripe.directives"]).provider("stripeConfig",a.default).service("httpService",o.default).service("stripeSource",s.default)},function(e,t,r){"use strict";function n(){function e(e,t,r){this.key=e,this.base_url=t,this.defaults=r}var t=!1,r="https://api.stripe.com/v1",n={add_card_amount:100,currency:"usd",redirect:null};this.set=function(e,u){t=e.apiKey,e.baseUrl&&(r=e.baseUrl),n=angular.extend({},n,u)},this.$get=[function(){return new e(t,r,n)}]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r,u){n(this,e),this.$http=t,this.stripeConfig=u,this.$httpParamSerializerJQLike=r}return u(e,[{key:"doRequest",value:function(e,t){var r=this.stripeConfig;return e.data&&(e.data.key=r.key),e.auth=!1,e.url=-1===e.url.indexOf(r.base_url)?""+r.base_url+e.url:e.url,e.data=this.$httpParamSerializerJQLike(e.data),e.headers=angular.extend({"Content-Type":"application/x-www-form-urlencoded"},e.headers,{auth:!1}),"function"!=typeof t?this.$http(e):this.$http(e).then(function(e){return t(e.status,e.data)}).catch(function(e){return t(e.status,e.error||e.data||e)})}}]),e}();a.$inject=["$http","$httpParamSerializerJQLike","stripeConfig"],t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=angular.extend,i=angular.forEach,o=function(e,t){return e.indexOf(t)>-1},c=function(){function e(t,r,u){n(this,e),this.$q=u,this.httpService=t,this.stripeConfig=r,this.defaults=a({currency:"usd",redirect_url:window.location.href,add_card_amount:100},r.defaults)}return u(e,[{key:"createCard",value:function(e){var t=this,r={type:"card"};return i(e.card,function(e,t){t&&(r["card["+t+"]"]=e)}),e.billing_add&&i(e.billing_add,function(e,t){if(o(["email","name","phone"],t))return r["owner["+t+"]"]=e;"address"===t?i(e,function(e,t){if(o(["postal_code","city","country","line1","line2","state"],t))return r["owner[address]["+t+"]"]=e}):"metadata"===t&&i(e,function(n,u){return r["metadata["+t+"]"]=e})}),new this.$q(function(n,u){var a=t.create3DSecure(e,n,u);return t.httpService.doRequest({data:r,url:"/sources",method:"POST"},a)})}},{key:"create3DSecure",value:function(e,t,r){var n=this;return function(u,i){if(200!==u||i.error)return r(i.error||i);if(e.cardResponse=i,"not_supported"===i.card.three_d_secure&&"chargeable"===i.status)return t(i);if("optional"===i.card.three_d_secure||"required"===i.card.three_d_secure){var o=a({},{amount:n.defaults.add_card_amount,currency:n.defaults.currency},{type:"three_d_secure",three_d_secure:{card:i.id},redirect:{return_url:e.redirect_url||n.defaults.redirect_url}}),c=n.makeIFrame(e,t,r);return n.httpService.doRequest({data:o,url:"/sources",method:"POST"},c)}return r(i)}}},{key:"authSource",value:function(e,t,r){var n=this;return function(e,u){var a={id:u.id,amount:n.defaults.add_card_amount};return n.httpService.doRequest({data:a,method:"POST",url:"/charges"}).then(function(e){return t(e.data)}).catch(function(e){return r(e.error)})}}},{key:"makeIFrame",value:function(e,t,r){var n=this;return function(u,a){if(200!==u||a.error)return r(a.error||a);var i=e.targetElement;i||(i=angular.element("<div></div>")[0],angular.element("body").append(i)),i.innerHTML='<iframe style="width:100%; height: 300px;" frameborder="0" src="'+a.redirect.url+'"></iframe>',e.nativeElement=i;var o=n.poolCallback(e,t,r);return n.watchSource(a.id,a.client_secret,o)}}},{key:"watchSource",value:function(e,t,r){var n=this;return this.httpService.doRequest({url:"/sources/"+e+"?key="+this.stripeConfig.key+"&client_secret="+t}).then(function(e){var t=e.data;return"pending"!==t.status&&r(e.status,t)}).then(function(u){return!1===u?n.watchSource(e,t,r):u}).catch(function(e){return r(400,{error:e})})}},{key:"poolCallback",value:function(e,t,r){return function(n,u){if(200!==n||u.error)return r(u.error);"canceled"===u.status||"consumed"===u.status||"failed"===u.status?(e.nativeElement.innerHTML="",r(u.status)):"chargeable"===u.status&&(e.nativeElement.innerHTML="",t(a(e.cardResponse,u)))}}}]),e}();c.$inject=["httpService","stripeConfig","$q"],t.default=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.default=angular.module("stripe.directives",[]).directive("createSourceToStripe",n.addCard.Factory)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.addCard=void 0;var n=r(6),u=function(e){return e&&e.__esModule?e:{default:e}}(n),a={addCard:u.default};t.addCard=u.default,t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.restrict="EA",this.stripeSource=t,this.scope={source:"=",onSuccess:"&",onFail:"&"},this.template='<div><button ng-click="save()">Save to Stripe</button></div>'}return u(e,[{key:"link",value:function(e,t,r){var n=this;e.onFail=e.onFail||angular.noop,e.onSuccess=e.onSuccess||angular.noop,e.source.targetElement=e.source.targetElement,e.source.targetElement||(e.source.targetElement=angular.element("<div>")[0],t.append(e.source.targetElement)),e.save=function(){n.stripeSource.createCard(e.source).then(function(t){return e.onSuccess({source:t})}).catch(function(t){return e.onFail({error:t})})}}}],[{key:"Factory",value:function(t){return new e(t)}}]),e}();a.Factory.$inject=["stripeSource"],t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=angular.module("paypal",[])},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var u=r(0),a=(n(u),r(7));n(a);e.exports=angular.module("ng-payments",["stripe"])}]);